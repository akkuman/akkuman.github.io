---
title: iis6-0 cve-2017-7269 批量验证脚本
date: 2017-04-01 12:44:52
tags:
- Tools
- Hacker
categories:
- Tools
---

[代码地址](https://gist.githubusercontent.com/iam1980/62ee37e38c7f76ca5d3889379e1d81fd/raw/aed9a3ef42bc6e6592913c5df8906ca6c57c9c66/getpro.py)

<!--more-->

```python
import subprocess

f = open('ips.txt', 'r')
flines = f.readlines()

vulnsrvs = 0
i = 1

for line in flines:

    host = line.split(":")

    ip = host[0].replace('\n','')
    port = host[1].replace('\n','')

    print "Try (" + str(i) +") "+ str(ip) +":" + str(port)

    if port == "443":
        #dont bother with SSL/TLS
        continue
    try:
        myout =  subprocess.check_output(['curl', '--connect-timeout', '2', '--max-time', '2', '-s','-I', '-X', 'PROPFIND','http://' + ip  + ':' + port + '/' ])
        print myout
        if "HTTP/1.1 411 Length Required" in myout:
            print "Found one:"
            print myout
            vulnsrvs += 1
    except Exception, e:
        print str(e.output)
    i += 1
    print "Vulnerable: " + str(vulnsrvs)
```

## 说明
ips.txt 是待验证的列表格式为：
```
129.112.44.1:80
129.112.44.2:81
129.112.44.43:8808
```
它不检测443端口（HTTPS）
你也可以简单改一下进行网段批量验证。

转自群友[CF_HB](http://www.loner.fm/article.php?id=24251)
