<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Akkuman 的技术博客</title><meta name=keywords content><meta name=description content="Posts - Akkuman 的技术博客"><meta name=author content><link rel=canonical href=https://www.hacktech.cn/post/><link crossorigin=anonymous href=https://cdn.jsdmirror.com/gh/akkuman/akkuman.github.io@master/assets/css/stylesheet.2824803599022172c5df03c979b2556dc526917d1f5a5d792793d0907875bfd9.css integrity="sha256-KCSANZkCIXLF3wPJebJVbcUmkX0fWl15J5PQkHh1v9k=" rel="preload stylesheet" as=style><link rel=icon href=https://www.hacktech.cn/images/avatar.webp><link rel=icon type=image/png sizes=16x16 href=https://www.hacktech.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.hacktech.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://www.hacktech.cn/apple-touch-icon.png><link rel=mask-icon href=https://www.hacktech.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://www.hacktech.cn/post/atom.xml><link rel=alternate hreflang=zh href=https://www.hacktech.cn/post/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&family=Source+Code+Pro&display=swap" rel=stylesheet><script async src=https://cn.vercount.one/js></script><meta property="og:url" content="https://www.hacktech.cn/post/"><meta property="og:site_name" content="Akkuman 的技术博客"><meta property="og:title" content="Posts"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.hacktech.cn/post/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.hacktech.cn/ accesskey=h title="Akkuman 的技术博客 (Alt + H)">Akkuman 的技术博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.hacktech.cn/archives/ title=归档><span>归档</span></a></li><li><a href=https://www.hacktech.cn/categories/ title=分类><span>分类</span></a></li><li><a href=https://www.hacktech.cn/search/ title=搜索><span>搜索</span></a></li><li><a href=https://www.hacktech.cn/tags/ title=标签><span>标签</span></a></li><li><a href=https://www.hacktech.cn/links/ title=友情链接><span>友情链接</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://www.hacktech.cn/>主页</a></div><h1>Posts
<a href=/post/atom.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>识别SigFlip生成的恶意文件</h2></header><div class=entry-content><p>最近在移植 med0x2e/SigFlip 的过程中发现了一个有意思的点，可以用来作为检测的手段
在 SigFlip 项目的 Detect/Prevent 一节中作者有提到一些检测防御手段
https://docs.microsoft.com/en-us/security-updates/SecurityAdvisories/2014/2915720?redirectedfrom=MSDN
Once the patch is installed and proper registry keys are set, No system restarts are required, you only need to restart the Cryptographic Services. The Applocker service will be also restarted as it depends on the cryptographic services.(@p0w3rsh3ll)
Yara rule by Adrien; https://twitter.com/Int2e_/status/1330975808941330432
从 SigFlip 源码中，其实也能发现一个点
SigFlip 依赖一串特定的字节来定位shellcode的位置，详见 Native/SigLoader/SigLoader/SigLoader.cpp#L102 和 Native/SigFlip/SigFlip/SigFlip.cpp#L232
1 2 3 4 5 6 7 for (_index = 0; _index &lt; _CertTableSize; _index++) { if (*(_pePtr + _index) == 0xfe && *(_pePtr + _index + 1) == 0xed && *(_pePtr + _index + 2) == 0xfa && *(_pePtr + _index + 3) == 0xce) { printf("[*]: Tag Found 0x%x%x%x%x", *(_pePtr + _index), *(_pePtr + _index+1), *(_pePtr + _index+2), *(_pePtr + _index+3)); _dataOffset = _index + 8; break; } } 1 2 memcpy(_encryptedData, "\xFE\xED\xFA\xCE\xFE\xED\xFA\xCE", 8); crypt((unsigned char*)_data, _dataSize, _key, _keySize, (unsigned char*)_encryptedData + 8); 也就是说我们在证书表中定位到 \xFE\xED\xFA\xCE\xFE\xED\xFA\xCE 这段特征就可以断定它疑似 SigFlip 生成的 payload 了，想要更精准一些可以结合 https://twitter.com/Int2e_/status/1330975808941330432 中提到的长度特征。
...</p></div><footer class=entry-footer><span title='2021-12-10 07:41:00 +0000 UTC'>十二月 10, 2021</span>&nbsp;·&nbsp;2 分钟</footer><a class=entry-link aria-label="post link to 识别SigFlip生成的恶意文件" href=https://www.hacktech.cn/post/2021/12/identify-sigflip-file/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>将newsletter转为rss</h2></header><div class=entry-content><p>相关的开源项目 https://github.com/leafac/kill-the-newsletter
作者提供了一个网站 https://kill-the-newsletter.com/ 来提供服务，截至20211119，至少已经提供了两年的服务了，所以稳定性还可
下面就是使用方法了
选择一个你要订阅的newsletter，比如 https://random-lab.ghost.io/
打开 https://kill-the-newsletter.com/ ，输入你要给该订阅取的名字，比如我输入 1000小食报 ，然后点击 create inbox
然后会提供给你一个邮箱和一个rss订阅地址
将邮箱地址填入第一步中的订阅邮箱
将rss订阅地址加到你的rss阅读器
一般情况下你会收到的第一个订阅消息是叫你确认订阅，点击确认地址即可
下面说下原理：
首先需要有个邮服，然后每次创建inbox的时候随机生成一个邮箱，并且将此邮箱的收件箱内容转为rss订阅暴露出来</p></div><footer class=entry-footer><span title='2021-12-06 08:09:00 +0000 UTC'>十二月 6, 2021</span>&nbsp;·&nbsp;1 分钟</footer><a class=entry-link aria-label="post link to 将newsletter转为rss" href=https://www.hacktech.cn/post/2021/12/newsletter2rss/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>网络空间检索平台对比</h2></header><div class=entry-content><p>最近网络空间检索平台雨后春笋般涌现，本篇文章以一个使用者的视角来做一下对比
...</p></div><footer class=entry-footer><span title='2021-10-27 09:40:45 +0000 UTC'>十月 27, 2021</span>&nbsp;·&nbsp;2 分钟</footer><a class=entry-link aria-label="post link to 网络空间检索平台对比" href=https://www.hacktech.cn/post/2021/10/net-search-platform-compare/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SonarQube钉钉通知插件</h2></header><div class=entry-content><p>网上看到的钉钉通知插件已经不适用于最新的 SonarQube 了，所以自己花了点时间撸了一下
...</p></div><footer class=entry-footer><span title='2021-09-29 04:22:47 +0000 UTC'>九月 29, 2021</span>&nbsp;·&nbsp;1 分钟</footer><a class=entry-link aria-label="post link to SonarQube钉钉通知插件" href=https://www.hacktech.cn/post/2021/09/proj-sonarqube-dingtalk-robot/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>golang实现dll恶意劫持转发</h2></header><div class=entry-content><p>本文章将讲解如何使用恶意的 Golang 来实现 dll 劫持转发
...</p></div><footer class=entry-footer><span title='2021-07-22 02:01:02 +0000 UTC'>七月 22, 2021</span>&nbsp;·&nbsp;9 分钟</footer><a class=entry-link aria-label="post link to golang实现dll恶意劫持转发" href=https://www.hacktech.cn/post/2021/07/golang-evil-dll-proxy/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://www.hacktech.cn/post/page/4/>«&nbsp;上一页&nbsp;
</a><a class=next href=https://www.hacktech.cn/post/page/6/>下一页&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://www.hacktech.cn/>Akkuman 的技术博客</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script defer src=https://umm.wodewo.win/script.js data-website-id=d14cc524-4c14-40da-876c-437d65176899></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>