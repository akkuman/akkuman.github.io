<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Win32汇编学习(11)：对话框(2) | Akkuman 的博客</title>
<meta name=keywords content="笔记,逆向"><meta name=description content="我们将进一步学习对话框，探讨如何把对话框当成输入设备。如果您看了前一篇文章，那就会发现这次的例子只有少量的改动，就是把我们的对话框窗口附属到主窗口上。另外，我们还要学习通用对话框的用法。"><meta name=author content><link rel=canonical href=//www.hacktech.cn/post/win32-asm-study-11.html><link crossorigin=anonymous href=https://cdn.jsdmirror.cn/gh/akkuman/akkuman.github.io@master/assets/css/stylesheet.142418288cf8384b5b23d3c55110c6dd453b3721afa20b1baddb9907d4f3d152.css integrity="sha256-FCQYKIz4OEtbI9PFURDG3UU7NyGvogsbrduZB9Tz0VI=" rel="preload stylesheet" as=style><link rel=icon href=//www.hacktech.cn/images/avatar.webp><link rel=icon type=image/png sizes=16x16 href=//www.hacktech.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=//www.hacktech.cn/favicon-32x32.png><link rel=apple-touch-icon href=//www.hacktech.cn/apple-touch-icon.png><link rel=mask-icon href=//www.hacktech.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=//www.hacktech.cn/post/win32-asm-study-11.html><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&family=Source+Code+Pro&display=swap" rel=stylesheet><script async src=https://cn.vercount.one/js></script><meta property="og:title" content="Win32汇编学习(11)：对话框(2)"><meta property="og:description" content="我们将进一步学习对话框，探讨如何把对话框当成输入设备。如果您看了前一篇文章，那就会发现这次的例子只有少量的改动，就是把我们的对话框窗口附属到主窗口上。另外，我们还要学习通用对话框的用法。"><meta property="og:type" content="article"><meta property="og:url" content="//www.hacktech.cn/post/win32-asm-study-11.html"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-02-13T18:23:00+00:00"><meta property="article:modified_time" content="2018-02-13T18:23:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Win32汇编学习(11)：对话框(2)"><meta name=twitter:description content="我们将进一步学习对话框，探讨如何把对话框当成输入设备。如果您看了前一篇文章，那就会发现这次的例子只有少量的改动，就是把我们的对话框窗口附属到主窗口上。另外，我们还要学习通用对话框的用法。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//www.hacktech.cn/post.html"},{"@type":"ListItem","position":2,"name":"Win32汇编学习(11)：对话框(2)","item":"//www.hacktech.cn/post/win32-asm-study-11.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Win32汇编学习(11)：对话框(2)","name":"Win32汇编学习(11)：对话框(2)","description":"我们将进一步学习对话框，探讨如何把对话框当成输入设备。如果您看了前一篇文章，那就会发现这次的例子只有少量的改动，就是把我们的对话框窗口附属到主窗口上。另外，我们还要学习通用对话框的用法。\n","keywords":["笔记","逆向"],"articleBody":"我们将进一步学习对话框，探讨如何把对话框当成输入设备。如果您看了前一篇文章，那就会发现这次的例子只有少量的改动，就是把我们的对话框窗口附属到主窗口上。另外，我们还要学习通用对话框的用法。\n理论： 把对话框当成一个输入设备来用确实是非常地简单，创建完主窗口后，您只要调用函数 DialogBoxParam或 CreateDialogParam 就可以了，前一个函数只要在对话框的过程处理函数中处理相关的消息就可以，而后者你必须在消息循环段中插入函数 IsDialogMessage 的调用让它来处理键盘的按键逻辑。因为这两个程序段相对来说比较容易，我们就不详解。您可以下载并仔细研究。 下面我们来讨论通用对话框。WINDOWS已经为您准备好了预定义的对话框类，您可以拿来就用，这些通用对话框提供给用户以统一的界面。它们包括:打开文件、打印、选择颜色、字体和搜索等。您应该尽可能地用它们。处理这些对话框的代码在comdlg32.dll中，为了在您的应用程序中使用它们，就必须在链接阶段链接库文件 comdlg32.lib。然后调用其中的相关函数即可。对于打开文件通用对话框，该函数名为 GetOpenFileName，“保存为…“对话框为 GetSaveFileName，打印通用对话框是 PrintDlg， 等等。每一个这样的函数都接收一个指向一个结构体的指针的参数，您可以参考WIN32 API手册得到详细的资料，本课中我将讲解创建和使用打开文件对话框。 下面是打开对话框函数 GetOpenFileName 的原型:\n1 GetOpenFileName proto lpofn:DWORD 您可以看到，该函数只有一个参数，即指向结构体OPENFILENAME的指针。当用户选择了一个文件并打开，该函数返回TRUE，否则返回FALSE。接下来我们看看结构体OPENFILENAME的定义:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 OPENFILENAME STRUCT lStructSize DWORD ? hwndOwner HWND ? hInstance HINSTANCE ? lpstrFilter LPCSTR ? lpstrCustomFilter LPSTR ? nMaxCustFilter DWORD ? nFilterIndex DWORD ? lpstrFile LPSTR ? nMaxFile DWORD ? lpstrFileTitle LPSTR ? nMaxFileTitle DWORD ? lpstrInitialDir LPCSTR ? lpstrTitle LPCSTR ? Flags DWORD ? nFileOffset WORD ? nFileExtension WORD ? lpstrDefExt LPCSTR ? lCustData LPARAM ? lpfnHook DWORD ? lpTemplateName LPCSTR ? OPENFILENAME ENDS 好，我们再来看看该结构体中常用的成员的意义:\nlStructSize 结构体OPENFILENAME的大小。 hwndOwner 拥有打开对话框的窗口的句柄。 hInstance 拥有该打开文件对话框的应用程序的实例句柄 。 lpstrFilter 以NULL结尾的一个或多个通配符。通配符是成对出现的，前一部分是描述部分，后一部分则是通配符的格式，譬如: 1 2 FilterString db \"All Files (*.*)\",0, \"*.*\",0 db \"Text Files (*.txt)\",0,\"*.txt\",0,0 注意:只有每一对中的第二部分是WINDOWS用来过滤所需选择的文件的，另外您必须在该部分后放置一个0，以示字符串的结束。\nnFilterIndex 用来指定打开文件对话框第一次打开时所用的过滤模式串，该索引是从1开始算的，即第一个通配符模式的索引是1，第二个是2，譬如上面的例子中，若指定该值为2，则缺省显示的模式串就是”*.txt”。 lpstrFile 需要打开的文件的名称的地址，该名称将会出现在打开文件对话框的编辑控件中，该缓冲区不能超过260个字符长，当用户打开文件后，该缓冲区中包含该文件的全路径名，您可以从该缓冲区中抽取您所需要的路径或文件名等信息。 nMaxFile lpstrFile的大小。 lpstrTitle 指向对话框标题的字符串。 Flags 该标志决定决定了对话框的风格和特点。 nFileOffset 在用户打开了一个文件后该值是全路径名称中指向文件名第一个字符的索引。譬如:若全路径名为\"c:\\windows\\system\\lz32.dll\"， 则该值为18。 nFileExtension 在用户打开了一个文件后该值是全路径名称中指向个文件扩展名第一个字符的索引。 例子: 下例中，我们演示了当用户选择\"File-\u003eOpen\"时，将弹出一个打开文件对话框，当用户选择了某个文件打开时，会弹出一个对话框，告知要打开的文件的全路径名，文件名和文件扩展名。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 .386 .model flat,stdcall option casemap:none WinMain proto :DWORD,:DWORD,:DWORD,:DWORD include \\masm32\\include\\windows.inc include \\masm32\\include\\user32.inc include \\masm32\\include\\kernel32.inc include \\masm32\\include\\comdlg32.inc includelib \\masm32\\lib\\user32.lib includelib \\masm32\\lib\\kernel32.lib includelib \\masm32\\lib\\comdlg32.lib .const IDM_OPEN equ 1 IDM_EXIT equ 2 MAXSIZE equ 260 OUTPUTSIZE equ 512 .data ClassName db \"SimpleWinClass\",0 AppName db \"Our Main Window\",0 MenuName db \"FirstMenu\",0 ofn OPENFILENAME \u003c\u003e FilterString db \"All Files\",0,\"*.*\",0 db \"Text Files\",0,\"*.txt\",0,0 buffer db MAXSIZE dup(0) OurTitle db \"-=Our First Open File Dialog Box=-: Choose the file to open\",0 FullPathName db \"The Full Filename with Path is: \",0 FullName db \"The Filename is: \",0 ExtensionName db \"The Extension is: \",0 OutputString db OUTPUTSIZE dup(0) CrLf db 0Dh,0Ah,0 .data? hInstance HINSTANCE ? CommandLine LPSTR ? .code start: invoke GetModuleHandle, NULL mov hInstance,eax invoke GetCommandLine mov CommandLine,eax invoke WinMain, hInstance,NULL,CommandLine, SW_SHOWDEFAULT invoke ExitProcess,eax WinMain proc hInst:HINSTANCE,hPrevInst:HINSTANCE,CmdLine:LPSTR,CmdShow:DWORD LOCAL wc:WNDCLASSEX LOCAL msg:MSG LOCAL hwnd:HWND mov wc.cbSize,SIZEOF WNDCLASSEX mov wc.style, CS_HREDRAW or CS_VREDRAW mov wc.lpfnWndProc, OFFSET WndProc mov wc.cbClsExtra,NULL mov wc.cbWndExtra,NULL push hInst pop wc.hInstance mov wc.hbrBackground,COLOR_WINDOW+1 mov wc.lpszMenuName,OFFSET MenuName mov wc.lpszClassName,OFFSET ClassName invoke LoadIcon,NULL,IDI_APPLICATION mov wc.hIcon,eax mov wc.hIconSm,eax invoke LoadCursor,NULL,IDC_ARROW mov wc.hCursor,eax invoke RegisterClassEx, addr wc invoke CreateWindowEx,WS_EX_CLIENTEDGE,ADDR ClassName,ADDR AppName,\\ WS_OVERLAPPEDWINDOW,CW_USEDEFAULT,\\ CW_USEDEFAULT,300,200,NULL,NULL,\\ hInst,NULL mov hwnd,eax invoke ShowWindow, hwnd,SW_SHOWNORMAL invoke UpdateWindow, hwnd .WHILE TRUE invoke GetMessage, ADDR msg,NULL,0,0 .BREAK .IF (!eax) invoke TranslateMessage, ADDR msg invoke DispatchMessage, ADDR msg .ENDW mov eax,msg.wParam ret WinMain endp WndProc proc hWnd:HWND, uMsg:UINT, wParam:WPARAM, lParam:LPARAM .IF uMsg==WM_DESTROY invoke PostQuitMessage,NULL .ELSEIF uMsg==WM_COMMAND mov eax,wParam .if ax==IDM_OPEN mov ofn.lStructSize,SIZEOF ofn push hWnd pop ofn.hwndOwner push hInstance pop ofn.hInstance mov ofn.lpstrFilter, OFFSET FilterString mov ofn.lpstrFile, OFFSET buffer mov ofn.nMaxFile,MAXSIZE mov ofn.Flags, OFN_FILEMUSTEXIST or \\ OFN_PATHMUSTEXIST or OFN_LONGNAMES or\\ OFN_EXPLORER or OFN_HIDEREADONLY mov ofn.lpstrTitle, OFFSET OurTitle invoke GetOpenFileName, ADDR ofn .if eax==TRUE invoke lstrcat,offset OutputString,OFFSET FullPathName invoke lstrcat,offset OutputString,ofn.lpstrFile invoke lstrcat,offset OutputString,offset CrLf invoke lstrcat,offset OutputString,offset FullName mov eax,ofn.lpstrFile push ebx xor ebx,ebx mov bx,ofn.nFileOffset add eax,ebx pop ebx invoke lstrcat,offset OutputString,eax invoke lstrcat,offset OutputString,offset CrLf invoke lstrcat,offset OutputString,offset ExtensionName mov eax,ofn.lpstrFile push ebx xor ebx,ebx mov bx,ofn.nFileExtension add eax,ebx pop ebx invoke lstrcat,offset OutputString,eax invoke MessageBox,hWnd,OFFSET OutputString,ADDR AppName,MB_OK invoke RtlZeroMemory,offset OutputString,OUTPUTSIZE .endif .else invoke DestroyWindow, hWnd .endif .ELSE invoke DefWindowProc,hWnd,uMsg,wParam,lParam ret .ENDIF xor eax,eax ret WndProc endp end start 1 2 3 4 5 6 7 8 9 10 11 ;-------------------------------------------------------------------------------- ;menu.rc ;-------------------------------------------------------------------------------- #define IDM_OPEN 1 #define IDM_EXIT 2 FirstMenu MENU { MENUITEM \"\u0026Open\",IDM_OPEN MENUITEM \"E\u0026xit\",IDM_EXIT } 分析: 1 2 3 4 5 mov ofn.lStructSize,SIZEOF ofn push hWnd pop ofn.hwndOwner push hInstance pop ofn.hInstance 我们在此填充结构体OPENFILENAME变量ofn的有关成员。\n1 mov ofn.lpstrFilter, OFFSET FilterString 这里FilterString 是文件过滤模式的字符串地址，我们指定的过滤模式字符串如下:\n1 2 FilterString db \"All Files\",0,\"*.*\",0 db \"Text Files\",0,\"*.txt\",0,0 注意:所有的模式串都是配对的，前一个是描述，后一个才是真正的模式，此处*.*和*.txt是WIONDOWS用来寻找匹配的欲打开的文件的。我们当能可以指定任何模式，但是不要忘记在结尾处加0以代表字符串已结束，否则您的对话框在操作时可能不稳定。\n1 2 mov ofn.lpstrFile, OFFSET buffer mov ofn.nMaxFile,MAXSIZE 这里是把缓冲区的地址放到结构体中，同时必须设定大小。以后我们可以随意编辑在该缓冲区中返回的信息。\n1 2 3 mov ofn.Flags, OFN_FILEMUSTEXIST or \\ OFN_PATHMUSTEXIST or OFN_LONGNAMES or\\ OFN_EXPLORER or OFN_HIDEREADONLY Flags 中放入的是对话框的风格和特性值。 其中OFN_FILEMUSTEXIST和 OFN_PATHMUSTEXIST要求用户在打开对话框的编辑控件中输入的文件名或路径名必须存在。 OFN_LONGNAMES 告诉对话框显示长文件名。 OFN_EXPLORER 告诉WINDOWS对话框的外观必须类似资源管理器。 OFN_HIDEREADONLY 指定不要显示只读文件(既使它的扩展名符合过滤模式)。 除此之外，还有许多其它的标志位，您可以参考有关WIN32 API手册。\n1 mov ofn.lpstrTitle, OFFSET OurTitle 指定打开文件对话框的标题名。\n1 invoke GetOpenFileName, ADDR ofn 调用GetOpenFileName函数，并传入指向结构体ofn的指针。 这时候，打开文件对话框就显示出来了，GetOpenFileName函数要一直等到用户选择了一个文件后才会返回，或者当用户按下了CANCEL键或关闭对话框时。 当用户选择了打开一个文件时，该函数返回TRUE， 否则返回FALSE。\n1 2 3 4 5 .if eax==TRUE invoke lstrcat,offset OutputString,OFFSET FullPathName invoke lstrcat,offset OutputString,ofn.lpstrFile invoke lstrcat,offset OutputString,offset CrLf invoke lstrcat,offset OutputString,offset FullName 当用户选择打开一个文件时，我们就在一个对话框中显示一个字符串，我们先给OutputString变量分配内存，然后调用PAI 函数lstrcat，把所有的字符串连到一起，为了让这些字符串分行显示，我们必须在每个字符串后面加一个换行符。\n1 2 3 4 5 6 7 mov eax,ofn.lpstrFile push ebx xor ebx,ebx mov bx,ofn.nFileOffset add eax,ebx pop ebx invoke lstrcat,offset OutputString,eax 上面这几行可能需要一些解释。nFileOffset的值等于被打开文件的全路径名中的文件名的第一个字符的索引，由于nFileOffset是一个WORD型变量，而lpstrFile是一个DWORD型的指针，所以我们就要作一转换把nFileOffset存入ebx寄存器的底字节，然后再加到eax寄存器中得到DWORD型的指针。\n1 invoke MessageBox,hWnd,OFFSET OutputString,ADDR AppName,MB_OK 我们在对话框中显示该字符串。\n1 invoke RtlZerolMemory,offset OutputString,OUTPUTSIZE 为了下一次能正确地显示，必须清除缓冲区，我们调用函数RtlZerolMemory来做这件事。\n","wordCount":"810","inLanguage":"zh","datePublished":"2018-02-13T18:23:00Z","dateModified":"2018-02-13T18:23:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"//www.hacktech.cn/post/win32-asm-study-11.html"},"publisher":{"@type":"Organization","name":"Akkuman 的博客","logo":{"@type":"ImageObject","url":"//www.hacktech.cn/images/avatar.webp"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//www.hacktech.cn/ accesskey=h title="Akkuman 的博客 (Alt + H)">Akkuman 的博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=//www.hacktech.cn/archives/ title=归档><span>归档</span></a></li><li><a href=//www.hacktech.cn/categories/ title=分类><span>分类</span></a></li><li><a href=//www.hacktech.cn/search/ title=搜索><span>搜索</span></a></li><li><a href=//www.hacktech.cn/tags/ title=标签><span>标签</span></a></li><li><a href=//www.hacktech.cn/links/ title=链接><span>链接</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//www.hacktech.cn/>主页</a>&nbsp;»&nbsp;<a href=//www.hacktech.cn/post.html>Posts</a></div><h1 class="post-title entry-hint-parent">Win32汇编学习(11)：对话框(2)</h1><div class=post-meta><span title='2018-02-13 18:23:00 +0000 UTC'>二月 13, 2018</span>&nbsp;·&nbsp;4 分钟&nbsp;·&nbsp;<span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>&nbsp;|&nbsp;<a href="mailto://akkumans@qq.com?subject=Suggesting%20changes%20for%20/post/win32-asm-study-11.md" rel="noopener noreferrer" target=_blank>给我邮件</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e7%90%86%e8%ae%ba aria-label=理论：>理论：</a></li><li><a href=#%e4%be%8b%e5%ad%90 aria-label=例子:>例子:</a></li><li><a href=#%e5%88%86%e6%9e%90 aria-label=分析:>分析:</a></li></ul></div></details></div><div class=post-content><p>我们将进一步学习对话框，探讨如何把对话框当成输入设备。如果您看了前一篇文章，那就会发现这次的例子只有少量的改动，就是把我们的对话框窗口附属到主窗口上。另外，我们还要学习通用对话框的用法。</p><h2 id=理论>理论：<a hidden class=anchor aria-hidden=true href=#理论>#</a></h2><p>把对话框当成一个输入设备来用确实是非常地简单，创建完主窗口后，您只要调用函数 <code>DialogBoxParam</code>或 <code>CreateDialogParam</code> 就可以了，前一个函数只要在对话框的过程处理函数中处理相关的消息就可以，而后者你必须在消息循环段中插入函数 <code>IsDialogMessage</code> 的调用让它来处理键盘的按键逻辑。因为这两个程序段相对来说比较容易，我们就不详解。您可以下载并仔细研究。
下面我们来讨论通用对话框。WINDOWS已经为您准备好了预定义的对话框类，您可以拿来就用，这些通用对话框提供给用户以统一的界面。它们包括:打开文件、打印、选择颜色、字体和搜索等。您应该尽可能地用它们。处理这些对话框的代码在<code>comdlg32.dll</code>中，为了在您的应用程序中使用它们，就必须在链接阶段链接库文件 <code>comdlg32.lib</code>。然后调用其中的相关函数即可。对于打开文件通用对话框，该函数名为 <code>GetOpenFileName</code>，&ldquo;保存为&mldr;&ldquo;对话框为 <code>GetSaveFileName</code>，打印通用对话框是 <code>PrintDlg</code>， 等等。每一个这样的函数都接收一个指向一个结构体的指针的参数，您可以参考WIN32 API手册得到详细的资料，本课中我将讲解创建和使用打开文件对话框。
下面是打开对话框函数 <code>GetOpenFileName</code> 的原型:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>GetOpenFileName proto lpofn:DWORD
</span></span></code></pre></td></tr></table></div></div><p>您可以看到，该函数只有一个参数，即指向结构体<code>OPENFILENAME</code>的指针。当用户选择了一个文件并打开，该函数返回<code>TRUE</code>，否则返回<code>FALSE</code>。接下来我们看看结构体<code>OPENFILENAME</code>的定义:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>OPENFILENAME  STRUCT 
</span></span><span style=display:flex><span> lStructSize DWORD  ? 
</span></span><span style=display:flex><span> hwndOwner HWND  ? 
</span></span><span style=display:flex><span> hInstance HINSTANCE ? 
</span></span><span style=display:flex><span> lpstrFilter LPCSTR  ? 
</span></span><span style=display:flex><span> lpstrCustomFilter LPSTR  ? 
</span></span><span style=display:flex><span> nMaxCustFilter DWORD  ? 
</span></span><span style=display:flex><span> nFilterIndex DWORD  ? 
</span></span><span style=display:flex><span> lpstrFile LPSTR  ? 
</span></span><span style=display:flex><span> nMaxFile DWORD  ? 
</span></span><span style=display:flex><span> lpstrFileTitle LPSTR  ? 
</span></span><span style=display:flex><span> nMaxFileTitle DWORD  ? 
</span></span><span style=display:flex><span> lpstrInitialDir LPCSTR  ? 
</span></span><span style=display:flex><span> lpstrTitle LPCSTR  ? 
</span></span><span style=display:flex><span> Flags  DWORD  ? 
</span></span><span style=display:flex><span> nFileOffset WORD  ? 
</span></span><span style=display:flex><span> nFileExtension WORD  ? 
</span></span><span style=display:flex><span> lpstrDefExt LPCSTR  ? 
</span></span><span style=display:flex><span> lCustData LPARAM  ? 
</span></span><span style=display:flex><span> lpfnHook DWORD  ? 
</span></span><span style=display:flex><span> lpTemplateName LPCSTR  ?
</span></span><span style=display:flex><span>OPENFILENAME  ENDS
</span></span></code></pre></td></tr></table></div></div><p>好，我们再来看看该结构体中常用的成员的意义:</p><ul><li><code>lStructSize</code> 结构体OPENFILENAME的大小。</li><li><code>hwndOwner</code> 拥有打开对话框的窗口的句柄。</li><li><code>hInstance</code> 拥有该打开文件对话框的应用程序的实例句柄 。</li><li><code>lpstrFilter</code> 以NULL结尾的一个或多个通配符。通配符是成对出现的，前一部分是描述部分，后一部分则是通配符的格式，譬如:</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>     FilterString   db &#34;All Files (*.*)&#34;,0, &#34;*.*&#34;,0 
</span></span><span style=display:flex><span>                            db &#34;Text Files (*.txt)&#34;,0,&#34;*.txt&#34;,0,0 
</span></span></code></pre></td></tr></table></div></div><p>注意:只有每一对中的第二部分是WINDOWS用来过滤所需选择的文件的，另外您必须在该部分后放置一个0，以示字符串的结束。</p><ul><li><code>nFilterIndex</code> 用来指定打开文件对话框第一次打开时所用的过滤模式串，该索引是从1开始算的，即第一个通配符模式的索引是1，第二个是2，譬如上面的例子中，若指定该值为2，则缺省显示的模式串就是&rdquo;*.txt&rdquo;。</li><li><code>lpstrFile</code> 需要打开的文件的名称的地址，该名称将会出现在打开文件对话框的编辑控件中，该缓冲区不能超过260个字符长，当用户打开文件后，该缓冲区中包含该文件的全路径名，您可以从该缓冲区中抽取您所需要的路径或文件名等信息。</li><li><code>nMaxFile</code> lpstrFile的大小。</li><li><code>lpstrTitle</code> 指向对话框标题的字符串。</li><li><code>Flags</code> 该标志决定决定了对话框的风格和特点。</li><li><code>nFileOffset</code> 在用户打开了一个文件后该值是全路径名称中指向文件名第一个字符的索引。譬如:若全路径名为"c:\windows\system\lz32.dll"， 则该值为18。</li><li><code>nFileExtension</code> 在用户打开了一个文件后该值是全路径名称中指向个文件扩展名第一个字符的索引。</li></ul><h2 id=例子>例子:<a hidden class=anchor aria-hidden=true href=#例子>#</a></h2><p>下例中，我们演示了当用户选择"File->Open"时，将弹出一个打开文件对话框，当用户选择了某个文件打开时，会弹出一个对话框，告知要打开的文件的全路径名，文件名和文件扩展名。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#f92672>.</span><span style=color:#ae81ff>386</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>.</span>model flat,stdcall 
</span></span><span style=display:flex><span>option casemap:none 
</span></span><span style=display:flex><span>WinMain proto :DWORD,:DWORD,:DWORD,:DWORD 
</span></span><span style=display:flex><span>include \masm32\include\windows<span style=color:#f92672>.</span>inc 
</span></span><span style=display:flex><span>include \masm32\include\user32<span style=color:#f92672>.</span>inc 
</span></span><span style=display:flex><span>include \masm32\include\kernel32<span style=color:#f92672>.</span>inc 
</span></span><span style=display:flex><span>include \masm32\include\comdlg32<span style=color:#f92672>.</span>inc 
</span></span><span style=display:flex><span>includelib \masm32\lib\user32<span style=color:#f92672>.</span>lib 
</span></span><span style=display:flex><span>includelib \masm32\lib\kernel32<span style=color:#f92672>.</span>lib 
</span></span><span style=display:flex><span>includelib \masm32\lib\comdlg32<span style=color:#f92672>.</span>lib 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>.</span><span style=color:#66d9ef>const</span> 
</span></span><span style=display:flex><span>IDM_OPEN equ <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>IDM_EXIT equ <span style=color:#ae81ff>2</span> 
</span></span><span style=display:flex><span>MAXSIZE equ <span style=color:#ae81ff>260</span> 
</span></span><span style=display:flex><span>OUTPUTSIZE equ <span style=color:#ae81ff>512</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>.</span>data 
</span></span><span style=display:flex><span>ClassName db <span style=color:#e6db74>&#34;SimpleWinClass&#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>AppName  db <span style=color:#e6db74>&#34;Our Main Window&#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>MenuName db <span style=color:#e6db74>&#34;FirstMenu&#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>ofn   OPENFILENAME <span style=color:#f92672>&lt;&gt;</span> 
</span></span><span style=display:flex><span>FilterString db <span style=color:#e6db74>&#34;All Files&#34;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#e6db74>&#34;*.*&#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>             db <span style=color:#e6db74>&#34;Text Files&#34;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#e6db74>&#34;*.txt&#34;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>buffer db MAXSIZE dup(<span style=color:#ae81ff>0</span>) 
</span></span><span style=display:flex><span>OurTitle db <span style=color:#e6db74>&#34;-=Our First Open File Dialog Box=-: Choose the file to open&#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>FullPathName db <span style=color:#e6db74>&#34;The Full Filename with Path is: &#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>FullName  db <span style=color:#e6db74>&#34;The Filename is: &#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>ExtensionName db <span style=color:#e6db74>&#34;The Extension is: &#34;</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>OutputString db OUTPUTSIZE dup(<span style=color:#ae81ff>0</span>) 
</span></span><span style=display:flex><span>CrLf db <span style=color:#ae81ff>0</span>Dh,<span style=color:#ae81ff>0</span>Ah,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>.</span>data<span style=color:#960050;background-color:#1e0010>?</span> 
</span></span><span style=display:flex><span>hInstance HINSTANCE <span style=color:#960050;background-color:#1e0010>?</span> 
</span></span><span style=display:flex><span>CommandLine LPSTR <span style=color:#960050;background-color:#1e0010>?</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>.</span>code 
</span></span><span style=display:flex><span>start: 
</span></span><span style=display:flex><span>    invoke GetModuleHandle, NULL 
</span></span><span style=display:flex><span>    mov    hInstance,eax 
</span></span><span style=display:flex><span>    invoke GetCommandLine
</span></span><span style=display:flex><span>    mov CommandLine,eax 
</span></span><span style=display:flex><span>    invoke WinMain, hInstance,NULL,CommandLine, SW_SHOWDEFAULT 
</span></span><span style=display:flex><span>    invoke ExitProcess,eax 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WinMain proc hInst:HINSTANCE,hPrevInst:HINSTANCE,CmdLine:LPSTR,CmdShow:DWORD 
</span></span><span style=display:flex><span>    LOCAL wc:WNDCLASSEX 
</span></span><span style=display:flex><span>    LOCAL msg:MSG 
</span></span><span style=display:flex><span>    LOCAL hwnd:HWND 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>cbSize,SIZEOF WNDCLASSEX 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>style, CS_HREDRAW <span style=color:#f92672>or</span> CS_VREDRAW 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>lpfnWndProc, OFFSET WndProc 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>cbClsExtra,NULL 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>cbWndExtra,NULL 
</span></span><span style=display:flex><span>    push  hInst 
</span></span><span style=display:flex><span>    pop   wc<span style=color:#f92672>.</span>hInstance 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>hbrBackground,COLOR_WINDOW<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>lpszMenuName,OFFSET MenuName 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>lpszClassName,OFFSET ClassName 
</span></span><span style=display:flex><span>    invoke LoadIcon,NULL,IDI_APPLICATION 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>hIcon,eax 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>hIconSm,eax 
</span></span><span style=display:flex><span>    invoke LoadCursor,NULL,IDC_ARROW 
</span></span><span style=display:flex><span>    mov   wc<span style=color:#f92672>.</span>hCursor,eax 
</span></span><span style=display:flex><span>    invoke RegisterClassEx, addr wc 
</span></span><span style=display:flex><span>    invoke CreateWindowEx,WS_EX_CLIENTEDGE,ADDR ClassName,ADDR AppName,\ 
</span></span><span style=display:flex><span>           WS_OVERLAPPEDWINDOW,CW_USEDEFAULT,\ 
</span></span><span style=display:flex><span>           CW_USEDEFAULT,<span style=color:#ae81ff>300</span>,<span style=color:#ae81ff>200</span>,NULL,NULL,\ 
</span></span><span style=display:flex><span>           hInst,NULL 
</span></span><span style=display:flex><span>    mov   hwnd,eax 
</span></span><span style=display:flex><span>    invoke ShowWindow, hwnd,SW_SHOWNORMAL 
</span></span><span style=display:flex><span>    invoke UpdateWindow, hwnd 
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>WHILE TRUE 
</span></span><span style=display:flex><span>        invoke GetMessage, ADDR msg,NULL,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span>BREAK <span style=color:#f92672>.</span>IF (<span style=color:#f92672>!</span>eax) 
</span></span><span style=display:flex><span>        invoke TranslateMessage, ADDR msg 
</span></span><span style=display:flex><span>        invoke DispatchMessage, ADDR msg 
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>ENDW 
</span></span><span style=display:flex><span>    mov     eax,msg<span style=color:#f92672>.</span>wParam 
</span></span><span style=display:flex><span>    ret 
</span></span><span style=display:flex><span>WinMain endp 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WndProc proc hWnd:HWND, uMsg:UINT, wParam:WPARAM, lParam:LPARAM 
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>IF uMsg<span style=color:#f92672>==</span>WM_DESTROY 
</span></span><span style=display:flex><span>        invoke PostQuitMessage,NULL 
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>ELSEIF uMsg<span style=color:#f92672>==</span>WM_COMMAND 
</span></span><span style=display:flex><span>        mov eax,wParam 
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span><span style=color:#66d9ef>if</span> ax<span style=color:#f92672>==</span>IDM_OPEN 
</span></span><span style=display:flex><span>            mov ofn<span style=color:#f92672>.</span>lStructSize,SIZEOF ofn 
</span></span><span style=display:flex><span>            push hWnd 
</span></span><span style=display:flex><span>            pop  ofn<span style=color:#f92672>.</span>hwndOwner 
</span></span><span style=display:flex><span>            push hInstance 
</span></span><span style=display:flex><span>            pop  ofn<span style=color:#f92672>.</span>hInstance 
</span></span><span style=display:flex><span>            mov  ofn<span style=color:#f92672>.</span>lpstrFilter, OFFSET FilterString 
</span></span><span style=display:flex><span>            mov  ofn<span style=color:#f92672>.</span>lpstrFile, OFFSET buffer 
</span></span><span style=display:flex><span>            mov  ofn<span style=color:#f92672>.</span>nMaxFile,MAXSIZE 
</span></span><span style=display:flex><span>            mov  ofn<span style=color:#f92672>.</span>Flags, OFN_FILEMUSTEXIST <span style=color:#f92672>or</span> \ 
</span></span><span style=display:flex><span>                OFN_PATHMUSTEXIST <span style=color:#f92672>or</span> OFN_LONGNAMES <span style=color:#f92672>or</span>\ 
</span></span><span style=display:flex><span>                OFN_EXPLORER <span style=color:#f92672>or</span> OFN_HIDEREADONLY 
</span></span><span style=display:flex><span>            mov  ofn<span style=color:#f92672>.</span>lpstrTitle, OFFSET OurTitle 
</span></span><span style=display:flex><span>            invoke GetOpenFileName, ADDR ofn 
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#66d9ef>if</span> eax<span style=color:#f92672>==</span>TRUE 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,OFFSET FullPathName 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,ofn<span style=color:#f92672>.</span>lpstrFile 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,offset CrLf 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,offset FullName 
</span></span><span style=display:flex><span>                mov  eax,ofn<span style=color:#f92672>.</span>lpstrFile 
</span></span><span style=display:flex><span>                push ebx 
</span></span><span style=display:flex><span>                xor  ebx,ebx 
</span></span><span style=display:flex><span>                mov  bx,ofn<span style=color:#f92672>.</span>nFileOffset 
</span></span><span style=display:flex><span>                add  eax,ebx 
</span></span><span style=display:flex><span>                pop  ebx 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,eax 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,offset CrLf 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,offset ExtensionName 
</span></span><span style=display:flex><span>                mov  eax,ofn<span style=color:#f92672>.</span>lpstrFile 
</span></span><span style=display:flex><span>                push ebx 
</span></span><span style=display:flex><span>                xor ebx,ebx 
</span></span><span style=display:flex><span>                mov  bx,ofn<span style=color:#f92672>.</span>nFileExtension 
</span></span><span style=display:flex><span>                add eax,ebx 
</span></span><span style=display:flex><span>                pop ebx 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,eax 
</span></span><span style=display:flex><span>                invoke MessageBox,hWnd,OFFSET OutputString,ADDR AppName,MB_OK 
</span></span><span style=display:flex><span>                invoke RtlZeroMemory,offset OutputString,OUTPUTSIZE 
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span>endif 
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span><span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span>            invoke DestroyWindow, hWnd 
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span>endif 
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>ELSE 
</span></span><span style=display:flex><span>        invoke DefWindowProc,hWnd,uMsg,wParam,lParam 
</span></span><span style=display:flex><span>        ret 
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>ENDIF 
</span></span><span style=display:flex><span>    xor    eax,eax 
</span></span><span style=display:flex><span>    ret 
</span></span><span style=display:flex><span>WndProc endp 
</span></span><span style=display:flex><span>end start
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>;--------------------------------------------------------------------------------
</span></span><span style=display:flex><span>;menu.rc
</span></span><span style=display:flex><span>;--------------------------------------------------------------------------------
</span></span><span style=display:flex><span>#define IDM_OPEN 1
</span></span><span style=display:flex><span>#define IDM_EXIT 2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FirstMenu MENU
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	MENUITEM &#34;&amp;Open&#34;,IDM_OPEN
</span></span><span style=display:flex><span>	MENUITEM &#34;E&amp;xit&#34;,IDM_EXIT
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=分析>分析:<a hidden class=anchor aria-hidden=true href=#分析>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            mov ofn.lStructSize,SIZEOF ofn 
</span></span><span style=display:flex><span>            push hWnd 
</span></span><span style=display:flex><span>            pop  ofn.hwndOwner 
</span></span><span style=display:flex><span>            push hInstance 
</span></span><span style=display:flex><span>            pop  ofn.hInstance 
</span></span></code></pre></td></tr></table></div></div><p>我们在此填充结构体OPENFILENAME变量ofn的有关成员。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            mov  ofn.lpstrFilter, OFFSET FilterString 
</span></span></code></pre></td></tr></table></div></div><p>这里<code>FilterString</code> 是文件过滤模式的字符串地址，我们指定的过滤模式字符串如下:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>FilterString db &#34;All Files&#34;,0,&#34;*.*&#34;,0 
</span></span><span style=display:flex><span>             db &#34;Text Files&#34;,0,&#34;*.txt&#34;,0,0
</span></span></code></pre></td></tr></table></div></div><p>注意:所有的模式串都是配对的，前一个是描述，后一个才是真正的模式，此处<code>*.*</code>和<code>*.txt</code>是WIONDOWS用来寻找匹配的欲打开的文件的。我们当能可以指定任何模式，但是不要忘记在结尾处加0以代表字符串已结束，否则您的对话框在操作时可能不稳定。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            mov  ofn.lpstrFile, OFFSET buffer 
</span></span><span style=display:flex><span>            mov  ofn.nMaxFile,MAXSIZE 
</span></span></code></pre></td></tr></table></div></div><p>这里是把缓冲区的地址放到结构体中，同时必须设定大小。以后我们可以随意编辑在该缓冲区中返回的信息。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            mov  ofn.Flags, OFN_FILEMUSTEXIST or \ 
</span></span><span style=display:flex><span>                OFN_PATHMUSTEXIST or OFN_LONGNAMES or\ 
</span></span><span style=display:flex><span>                OFN_EXPLORER or OFN_HIDEREADONLY 
</span></span></code></pre></td></tr></table></div></div><p><code>Flags</code> 中放入的是对话框的风格和特性值。
其中<code>OFN_FILEMUSTEXIST</code>和 <code>OFN_PATHMUSTEXIST</code>要求用户在打开对话框的编辑控件中输入的文件名或路径名必须存在。
<code>OFN_LONGNAMES</code> 告诉对话框显示长文件名。
<code>OFN_EXPLORER</code> 告诉WINDOWS对话框的外观必须类似资源管理器。
<code>OFN_HIDEREADONLY</code> 指定不要显示只读文件(既使它的扩展名符合过滤模式)。
除此之外，还有许多其它的标志位，您可以参考有关WIN32 API手册。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            mov  ofn.lpstrTitle, OFFSET OurTitle 
</span></span></code></pre></td></tr></table></div></div><p>指定打开文件对话框的标题名。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            invoke GetOpenFileName, ADDR ofn 
</span></span></code></pre></td></tr></table></div></div><p>调用<code>GetOpenFileName</code>函数，并传入指向结构体<code>ofn</code>的指针。
这时候，打开文件对话框就显示出来了，<code>GetOpenFileName</code>函数要一直等到用户选择了一个文件后才会返回，或者当用户按下了<code>CANCEL</code>键或关闭对话框时。
当用户选择了打开一个文件时，该函数返回<code>TRUE</code>， 否则返回<code>FALSE</code>。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>            .if eax==TRUE 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,OFFSET FullPathName 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,ofn.lpstrFile 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,offset CrLf 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,offset FullName 
</span></span></code></pre></td></tr></table></div></div><p>当用户选择打开一个文件时，我们就在一个对话框中显示一个字符串，我们先给<code>OutputString</code>变量分配内存，然后调用PAI 函数<code>lstrcat</code>，把所有的字符串连到一起，为了让这些字符串分行显示，我们必须在每个字符串后面加一个换行符。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>                mov  eax,ofn.lpstrFile 
</span></span><span style=display:flex><span>                push ebx 
</span></span><span style=display:flex><span>                xor  ebx,ebx 
</span></span><span style=display:flex><span>                mov  bx,ofn.nFileOffset 
</span></span><span style=display:flex><span>                add  eax,ebx 
</span></span><span style=display:flex><span>                pop  ebx 
</span></span><span style=display:flex><span>                invoke lstrcat,offset OutputString,eax 
</span></span></code></pre></td></tr></table></div></div><p>上面这几行可能需要一些解释。<code>nFileOffset</code>的值等于被打开文件的全路径名中的文件名的第一个字符的索引，由于<code>nFileOffset</code>是一个WORD型变量，而<code>lpstrFile</code>是一个DWORD型的指针，所以我们就要作一转换把<code>nFileOffset</code>存入ebx寄存器的底字节，然后再加到eax寄存器中得到DWORD型的指针。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>                invoke MessageBox,hWnd,OFFSET OutputString,ADDR AppName,MB_OK 
</span></span></code></pre></td></tr></table></div></div><p>我们在对话框中显示该字符串。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>                invoke RtlZerolMemory,offset OutputString,OUTPUTSIZE 
</span></span></code></pre></td></tr></table></div></div><p>为了下一次能正确地显示，必须清除缓冲区，我们调用函数<code>RtlZerolMemory</code>来做这件事。</p></div><footer class=post-footer><ul class=post-tags><li><a href=//www.hacktech.cn/tags/%E7%AC%94%E8%AE%B0.html>笔记</a></li><li><a href=//www.hacktech.cn/tags/%E9%80%86%E5%90%91.html>逆向</a></li></ul><nav class=paginav><a class=prev href=//www.hacktech.cn/post/difference-between-dialog-and-window.html><span class=title>« 上一页</span><br><span>对话框和普通窗口工作方式的区别</span>
</a><a class=next href=//www.hacktech.cn/post/win32-asm-study-10.html><span class=title>下一页 »</span><br><span>Win32汇编学习(10)：对话框(1)</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on x" href="https://x.com/intent/tweet/?text=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29&amp;url=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html&amp;hashtags=%e7%ac%94%e8%ae%b0%2c%e9%80%86%e5%90%91"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html&amp;title=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29&amp;summary=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29&amp;source=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on reddit" href="https://reddit.com/submit?url=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html&title=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on facebook" href="https://facebook.com/sharer/sharer.php?u=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on whatsapp" href="https://api.whatsapp.com/send?text=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29%20-%20%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on telegram" href="https://telegram.me/share/url?text=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29&amp;url=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Win32汇编学习(11)：对话框(2) on ycombinator" href="https://news.ycombinator.com/submitlink?t=Win32%e6%b1%87%e7%bc%96%e5%ad%a6%e4%b9%a0%2811%29%ef%bc%9a%e5%af%b9%e8%af%9d%e6%a1%86%282%29&u=%2f%2fwww.hacktech.cn%2fpost%2fwin32-asm-study-11.html"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://cdn.jsdelivr.net/npm/@waline/client></script><div id=waline></div><script>new Waline({el:"#waline",serverURL:"https://blog-waline-api-d1lk7kqu8-akkum4n.vercel.app",visitor:!0,dark:"body.dark",requiredMeta:["nick","mail"],uploadImage:!1,copyright:!0,locale:{placeholder:"欢迎评论"}})</script></article></main><footer class=footer><span>&copy; 2024 <a href=//www.hacktech.cn/>Akkuman 的博客</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>