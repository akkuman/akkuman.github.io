<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>网络安全 on Akkuman 的博客</title>
    <link>//hacktech.cn/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/</link>
    <description>Recent content in 网络安全 on Akkuman 的博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Fri, 10 Dec 2021 07:41:00 +0000</lastBuildDate><atom:link href="//hacktech.cn/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/atom.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>识别SigFlip生成的恶意文件</title>
      <link>//hacktech.cn/2021/12/10/identify-sigflip-file/</link>
      <pubDate>Fri, 10 Dec 2021 07:41:00 +0000</pubDate>
      
      <guid>//hacktech.cn/2021/12/10/identify-sigflip-file/</guid>
      <description>最近在移植 med0x2e/SigFlip 的过程中发现了一个有意思的点，可以用来作为检测的手段
在 SigFlip 项目的 Detect/Prevent 一节中作者有提到一些检测防御手段
https://docs.microsoft.com/en-us/security-updates/SecurityAdvisories/2014/2915720?redirectedfrom=MSDN
Once the patch is installed and proper registry keys are set, No system restarts are required, you only need to restart the Cryptographic Services. The Applocker service will be also restarted as it depends on the cryptographic services.(@p0w3rsh3ll)
Yara rule by Adrien; https://twitter.com/Int2e_/status/1330975808941330432
从 SigFlip 源码中，其实也能发现一个点
SigFlip 依赖一串特定的字节来定位shellcode的位置，详见 Native/SigLoader/SigLoader/SigLoader.cpp#L102 和 Native/SigFlip/SigFlip/SigFlip.cpp#L232
1 2 3 4 5 6 7 for (_index = 0; _index &amp;lt; _CertTableSize; _index++) { if (*(_pePtr + _index) == 0xfe &amp;amp;&amp;amp; *(_pePtr + _index + 1) == 0xed &amp;amp;&amp;amp; *(_pePtr + _index + 2) == 0xfa &amp;amp;&amp;amp; *(_pePtr + _index + 3) == 0xce) { printf(&amp;#34;[*]: Tag Found 0x%x%x%x%x&amp;#34;, *(_pePtr + _index), *(_pePtr + _index+1), *(_pePtr + _index+2), *(_pePtr + _index+3)); _dataOffset = _index + 8; break; } } 1 2 memcpy(_encryptedData, &amp;#34;\xFE\xED\xFA\xCE\xFE\xED\xFA\xCE&amp;#34;, 8); crypt((unsigned char*)_data, _dataSize, _key, _keySize, (unsigned char*)_encryptedData + 8); 也就是说我们在证书表中定位到 \xFE\xED\xFA\xCE\xFE\xED\xFA\xCE 这段特征就可以断定它疑似 SigFlip 生成的 payload 了，想要更精准一些可以结合 https://twitter.</description>
    </item>
    
  </channel>
</rss>
