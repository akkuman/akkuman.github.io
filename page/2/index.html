<!doctype html><html lang=zh dir=auto><head><meta name=generator content="Hugo 0.101.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Akkuman 的博客</title><meta name=description content><meta name=author content><link rel=canonical href=//hacktech.cn/><link crossorigin=anonymous href=https://cdn.jsdelivr.net/gh/akkuman/akkuman.github.io@master/assets/css/stylesheet.4158007d1975708d1c78a5f18d877b728f8457f9c790b3dc013638bba69ea19d.css integrity="sha256-QVgAfRl1cI0ceKXxjYd7co+EV/nHkLPcATY4u6aeoZ0=" rel="preload stylesheet" as=style><link rel=icon href=//hacktech.cn/images/avatar.webp><link rel=icon type=image/png sizes=16x16 href=//hacktech.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=//hacktech.cn/favicon-32x32.png><link rel=apple-touch-icon href=//hacktech.cn/apple-touch-icon.png><link rel=mask-icon href=//hacktech.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=//hacktech.cn/atom.xml><link rel=alternate type=application/json href=//hacktech.cn/index.json><link rel=alternate hreflang=zh href=//hacktech.cn/><link rel=alternate hreflang=en href=//hacktech.cn/en/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&family=Source+Code+Pro&display=swap" rel=stylesheet><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta property="og:title" content="Akkuman 的博客"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="//hacktech.cn/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Akkuman 的博客"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Akkuman 的博客","url":"//hacktech.cn/","description":"","thumbnailUrl":"//hacktech.cn/images/avatar.webp","sameAs":["https://github.com/akkuman","https://akkuman.cnblogs.com","atom.xml","https://twitter.com/akkum4n","mailto://akkumans@qq.com","/images/wechat_contcat.jpg"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//hacktech.cn/ accesskey=h title="Akkuman 的博客 (Alt + H)">Akkuman 的博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=//hacktech.cn/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=//hacktech.cn/archives/ title=归档><span>归档</span></a></li><li><a href=//hacktech.cn/categories/ title=分类><span>分类</span></a></li><li><a href=//hacktech.cn/search/ title=搜索><span>搜索</span></a></li><li><a href=//hacktech.cn/tags/ title=标签><span>标签</span></a></li><li><a href=//hacktech.cn/links/ title=链接><span>链接</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>自建bitwarden备份同步到坚果云</h2></header><div class=entry-content><p>因为bitwarden的氪金玩家才能使用双因子认证，恰好手上有个vps，搭建个bitwarden服务端来使用2fa
自建bitwarden vps比较垃圾，所以选用一个资源开销比较小的服务端比较有必要，我这里选择的是 https://github.com/mprasil/bitwarden_rs
这里采用 docker-compose 进行部署
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 version: '3' services: bitwarden: image: bitwardenrs/server:latest container_name: bitwarden restart: unless-stopped volumes: - ./bw-data:/data environment: - WEBSOCKET_ENABLED=true - SIGNUPS_ALLOWED=true - WEB_VAULT_ENABLED=true - ADMIN_TOKEN=xxxxxxxxxxxxxxxxxxxx ports: - "127.0.0.1:8889:80" - "127.0.0.1:8810:3012" 其中的3012是websocket通知端口
WEBSOCKET_ENABLED 代表启用 websocket
SIGNUPS_ALLOWED 代表是否启用注册
WEB_VAULT_ENABLED 代表是否启用web界面
ADMIN_TOKEN 是管理界面的密码，用来启用管理界面，启用后可通过 [https://你的域名/admin](https://你的域名/admin) 进行访问
然后我们需要创建一个反向代理，这里我使用的是 nginx，下面给出 nginx 配置
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 upstream bitwarden-default { server 127....</p></div><footer class=entry-footer><span title='2021-12-10 09:00:00 +0000 UTC'>十二月 10, 2021</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;<span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span></footer><a class=entry-link aria-label="post link to 自建bitwarden备份同步到坚果云" href=//hacktech.cn/2021/12/10/selfhost-bitwarden-sync-nutstore/></a></article><article class=post-entry><header class=entry-header><h2>notion实现自动发布到hugo github博客</h2></header><div class=entry-content><p>notion是用来记录笔记的，hugo是我用来作为github博客自动构建发布的
我目前设置了一个github action是：当我的博客仓库hugo分支有push事件时，自动构建文章发布到master分支，并且发布到博客园。
但是会有这样的不便：在notion中写了一篇笔记或文章，想要发布到github静态博客上，发现需要先将文章转化成markdown，图片需要上传到图床，然后贴入markdown，然后再推送到github，等待action自动构建静态博客
既然我使用notion记录笔记，何不继续All-in-one，将notion作为我的博客发布工具。
只需要在 notion 中建立一个用于博客发布的 database，然后写完笔记后填入这个 database，再使用一些手段触发 CI 即可完成博客文章的发布
工具介绍 说干就干，写了两个工具
https://github.com/akkuman/notiontomd
https://github.com/akkuman/notion_to_github_blog
notiontomd 是用来notion中的某个page转化为markdown的库，当然，当前支持的block是有限的，详细信息可以查看该仓库
notion_to_github_blog则是一个github action模板，用来自动从指定格式的database中拉取需要更新发布的文章，然后利用 notiontomd 转化为markdown，然后推送到github仓库，再触发另外的github aciton进行博客静态文件构建
使用 怎么建仓怎么自动从某分支拉取推到github pages所在分支我就不展开说明了，感兴趣的可以去网上搜索相关资料，本文所关注的流程是从notion database到博客源文件
基础环境 本文所涉及到的例子环境可以前往我的博客仓库 https://github.com/akkuman/akkuman.github.io 进行查看
hugo分支用来存放博客源文件，其中有一个github action的功能是push时触发，然后自动构建推送到master分支
master分支用来存放hugo构建之后生成的站点静态文件
博客相关的图片我会推送到 https://github.com/akkuman/pic 仓库
hugo作为主分支，master设置为github pages分支（原因后面描述）
workflows编写 要使用该action，首先你需要在 notion 中创建一个 database，这个 database 需要有几个字段，字段名如下:
Name (title): 文章标题
Article (text): 文章链接
MDFilename (text): 创建的 markdown 文件名
Category (select): 文章分类
Tags (multi_select): 文章标签
IsPublish (checkbox): 文章是否发布
NeedUpdate (checkbox): 文章是否有更新
CreateAt (Created time): 创建时间...</p></div><footer class=entry-footer><span title='2021-12-10 07:51:00 +0000 UTC'>十二月 10, 2021</span>&nbsp;·&nbsp;3 分钟&nbsp;·&nbsp;<span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span></footer><a class=entry-link aria-label="post link to notion实现自动发布到hugo github博客" href=//hacktech.cn/2021/12/10/notion-to-github-blog/></a></article><article class=post-entry><header class=entry-header><h2>识别SigFlip生成的恶意文件</h2></header><div class=entry-content><p>最近在移植 med0x2e/SigFlip 的过程中发现了一个有意思的点，可以用来作为检测的手段
在 SigFlip 项目的 Detect/Prevent 一节中作者有提到一些检测防御手段
https://docs.microsoft.com/en-us/security-updates/SecurityAdvisories/2014/2915720?redirectedfrom=MSDN
Once the patch is installed and proper registry keys are set, No system restarts are required, you only need to restart the Cryptographic Services. The Applocker service will be also restarted as it depends on the cryptographic services.(@p0w3rsh3ll)
Yara rule by Adrien; https://twitter.com/Int2e_/status/1330975808941330432
从 SigFlip 源码中，其实也能发现一个点
SigFlip 依赖一串特定的字节来定位shellcode的位置，详见 Native/SigLoader/SigLoader/SigLoader.cpp#L102 和 Native/SigFlip/SigFlip/SigFlip.cpp#L232
1 2 3 4 5 6 7 for (_index = 0; _index &lt; _CertTableSize; _index++) { if (*(_pePtr + _index) == 0xfe && *(_pePtr + _index + 1) == 0xed && *(_pePtr + _index + 2) == 0xfa && *(_pePtr + _index + 3) == 0xce) { printf("[*]: Tag Found 0x%x%x%x%x", *(_pePtr + _index), *(_pePtr + _index+1), *(_pePtr + _index+2), *(_pePtr + _index+3)); _dataOffset = _index + 8; break; } } 1 2 memcpy(_encryptedData, "\xFE\xED\xFA\xCE\xFE\xED\xFA\xCE", 8); crypt((unsigned char*)_data, _dataSize, _key, _keySize, (unsigned char*)_encryptedData + 8); 也就是说我们在证书表中定位到 \xFE\xED\xFA\xCE\xFE\xED\xFA\xCE 这段特征就可以断定它疑似 SigFlip 生成的 payload 了，想要更精准一些可以结合 https://twitter....</p></div><footer class=entry-footer><span title='2021-12-10 07:41:00 +0000 UTC'>十二月 10, 2021</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;<span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span></footer><a class=entry-link aria-label="post link to 识别SigFlip生成的恶意文件" href=//hacktech.cn/2021/12/10/identify-sigflip-file/></a></article><article class=post-entry><header class=entry-header><h2>将newsletter转为rss</h2></header><div class=entry-content><p>相关的开源项目 https://github.com/leafac/kill-the-newsletter
作者提供了一个网站 https://kill-the-newsletter.com/ 来提供服务，截至20211119，至少已经提供了两年的服务了，所以稳定性还可
下面就是使用方法了
选择一个你要订阅的newsletter，比如 https://random-lab.ghost.io/
打开 https://kill-the-newsletter.com/ ，输入你要给该订阅取的名字，比如我输入 1000小食报 ，然后点击 create inbox
然后会提供给你一个邮箱和一个rss订阅地址
将邮箱地址填入第一步中的订阅邮箱
将rss订阅地址加到你的rss阅读器
一般情况下你会收到的第一个订阅消息是叫你确认订阅，点击确认地址即可
下面说下原理：
首先需要有个邮服，然后每次创建inbox的时候随机生成一个邮箱，并且将此邮箱的收件箱内容转为rss订阅暴露出来</p></div><footer class=entry-footer><span title='2021-12-06 08:09:00 +0000 UTC'>十二月 6, 2021</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;<span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span></footer><a class=entry-link aria-label="post link to 将newsletter转为rss" href=//hacktech.cn/2021/12/06/newsletter2rss/></a></article><article class=post-entry><header class=entry-header><h2>网络空间检索平台对比</h2></header><div class=entry-content><p>最近网络空间检索平台雨后春笋般涌现，本篇文章以一个使用者的视角来做一下对比
...</p></div><footer class=entry-footer><span title='2021-10-27 09:40:45 +0000 UTC'>十月 27, 2021</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;<span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span></footer><a class=entry-link aria-label="post link to 网络空间检索平台对比" href=//hacktech.cn/2021/10/27/net-search-platform-compare/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=//hacktech.cn/>« 上一页</a>
<a class=next href=//hacktech.cn/page/3/>下一页 »</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href=//hacktech.cn/>Akkuman 的博客</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>